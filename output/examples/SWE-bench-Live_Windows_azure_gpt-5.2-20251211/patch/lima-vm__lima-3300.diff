
diff --git a/cmd/limactl/copy.go b/cmd/limactl/copy.go
index d6333399..ff8d7bca 100644
--- a/cmd/limactl/copy.go
+++ b/cmd/limactl/copy.go
@@ -8,7 +8,6 @@ import (
        "fmt"
        "os"
        "os/exec"
-       "strings"

        "github.com/coreos/go-semver/semver"
        "github.com/lima-vm/lima/pkg/sshutil"
@@ -80,13 +79,15 @@ func copyAction(cmd *cobra.Command, args []string) error {  
        // this assumes that ssh and scp come from the same place, but scp has n
no -V
        legacySSH := sshutil.DetectOpenSSHVersion("ssh").LessThan(*semver.New("8
8.0.0"))
        for _, arg := range args {
-               path := strings.Split(arg, ":")
-               switch len(path) {
-               case 1:
+               instName, guestPath, isGuest, err := splitInstancePath(arg)     
+               if err != nil {
+                       return err
+               }
+               if !isGuest {
                        scpArgs = append(scpArgs, arg)
-               case 2:
-                       instName := path[0]
-                       inst, err := store.Inspect(instName)
+                       continue
+               }
+               inst, err := store.Inspect(instName)
                        if err != nil {
                                if errors.Is(err, os.ErrNotExist) {
                                        return fmt.Errorf("instance %q does not 
 exist, run `limactl create %s` to create a new instance", instName, instName)   
@@ -98,14 +99,11 @@ func copyAction(cmd *cobra.Command, args []string) error {  
                        }
                        if legacySSH {
                                scpFlags = append(scpFlags, "-P", fmt.Sprintf("%
%d", inst.SSHLocalPort))
-                               scpArgs = append(scpArgs, fmt.Sprintf("%s@127.0.
.0.1:%s", *inst.Config.User.Name, path[1]))
+                               scpArgs = append(scpArgs, fmt.Sprintf("%s@127.0.
.0.1:%s", *inst.Config.User.Name, guestPath))
                        } else {
-                               scpArgs = append(scpArgs, fmt.Sprintf("scp://%s@
@127.0.0.1:%d/%s", *inst.Config.User.Name, inst.SSHLocalPort, path[1]))
+                               scpArgs = append(scpArgs, fmt.Sprintf("scp://%s@
@127.0.0.1:%d/%s", *inst.Config.User.Name, inst.SSHLocalPort, guestPath))        
                        }
                        instances[instName] = inst
-               default:
-                       return fmt.Errorf("path %q contains multiple colons", ar
rg)
-               }
        }
        if legacySSH && len(instances) > 1 {
                return errors.New("more than one (instance) host is involved in 
 this command, this is only supported for openSSH v8.0 or higher")
diff --git a/cmd/limactl/shell.go b/cmd/limactl/shell.go
index 3dee0bac..c98f38c7 100644
--- a/cmd/limactl/shell.go
+++ b/cmd/limactl/shell.go
@@ -93,7 +93,9 @@ func shellAction(cmd *cobra.Command, args []string) error {   
        } else if len(inst.Config.Mounts) > 0 {
                hostCurrentDir, err := os.Getwd()
                if err == nil {
-                       changeDirCmd = fmt.Sprintf("cd %s", shellescape.Quote(ho
ostCurrentDir))
+                       if guestWD := guestWorkdirFromHost(hostCurrentDir); gues
stWD != "" {
+                               changeDirCmd = fmt.Sprintf("cd %s", shellescape.
.Quote(guestWD))
+                       }
                } else {
                        changeDirCmd = "false"
                        logrus.WithError(err).Warn("failed to get the current di
irectory")
diff --git a/pkg/sshutil/sshutil.go b/pkg/sshutil/sshutil.go
index 891279d2..561f4cee 100644
--- a/pkg/sshutil/sshutil.go
+++ b/pkg/sshutil/sshutil.go
@@ -98,8 +98,12 @@ func DefaultPubKeys(loadDotSSH bool) ([]PubKey, error) {     
                }
                if err := lockutil.WithDirLock(configDir, func() error {        
                        // no passphrase, no user@host comment
+                       privateKeyPath := filepath.Join(configDir, filenames.Use
erPrivateKey)
+if runtime.GOOS == "windows" {
+                               privateKeyPath = ioutilx.CanonicalWindowsPath(pr
rivateKeyPath)
+                       }
                        keygenCmd := exec.Command("ssh-keygen", "-t", "ed25519",
, "-q", "-N", "",
-                               "-C", "lima", "-f", filepath.Join(configDir, fil
lenames.UserPrivateKey))
+                               "-C", "lima", "-f", privateKeyPath)
                        logrus.Debugf("executing %v", keygenCmd.Args)
                        if out, err := keygenCmd.CombinedOutput(); err != nil { 
                                return fmt.Errorf("failed to run %v: %q: %w", ke
eygenCmd.Args, string(out), err)

